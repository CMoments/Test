埃筛和欧拉筛，能筛素数以及积性函数(推荐掌握)。

时间复杂度分别是 $\mathcal O(n\log\log n)$ 和 $\mathcal O(n)$。

还有一些筛法，是求一类特殊函数(如积性函数)的前缀和，比如杜教筛和 min25 筛或洲阁筛(不要求掌握，省赛和国赛虽然可能考，但那个分数不要也能全省第一)。

时间复杂度分别是 $\mathcal O(n^\frac{2}{3}), \mathcal O(\frac{n^{\frac{3}{4}}}{\log n}+n^{1-\omega}),O(\frac{n^{\frac{3}{4}}}{\log n}).$ 

埃筛：

$n$ 如果不是素数，则一定存在一个数 $p$，满足 $p\neq 1,n,p\mid n$。

```cpp
for (int i = 2; i <= n; i++) {
  	for (int j = i + i; j <= n; j += i) {
      	vis[j] = 1;
    }
}
// 时间复杂度 O(n log n)
```

但实际上，我们只需要 $p$ 是素数。

```cpp
for (int i = 2; i <= n; i++) {
  	if (vis[i])continue;
  	for (int j = i + i; j <= n; j += i) {
      	vis[j] = 1;
    }
}
// 时间复杂度 O(n log log n)
```

素数分布定理：$\pi(n)\sim \frac{n}{\ln n}$。

欧拉筛：

实际上，我们对于每个 $n$，只需要它的最小质因子去筛。

```cpp
for (int i = 2; i <= n; i++) {
  	if (!vis[i]) {
      	prim.push_back(i);
    }
  	for (int j = 0; j < prim.size() && prim[j] * i <= n; j++) {
      	vis[prim[j] * i] = 1;
      	if (i % prim[j] == 0)break;
    }
}
// 时间复杂度 O(n)
```

积性函数 $f$ 满足 $f(ab)=f(a)f(b),\gcd(a,b)=1$。

完全积性函数 $f$ 满足 $f(ab)=f(a)f(b)$。

```cpp
for (int i = 2; i <= n; i++) {
  	if (!vis[i]) {
      	prim.push_back(i);
      	f[i] = F(i);
    }
  	for (int j = 0; j < prim.size() && prim[j] * i <= n; j++) {
      	vis[prim[j] * i] = 1;
      	if (i % prim[j] == 0) {
          	
        }
      	else {
          	f[prim[j] * i] = f[prim[j]] * f[i];
        }
    }
}
```

$$
\varphi(p)=p-1,\varphi(1) =1,\varphi(p^i)=p^i-p^{i-1}=p^{i-1}(p-1)\\
\varphi(ab)=\varphi(a)\varphi(b)\gcd(a,b)/\varphi(\gcd(a,b))
$$

$$
n=\prod p_i^{e_i}\\
$$

质因子个数：$\sum [e_i>0]$。

质因子的和：$\sum p_i[e_i>0]$。

约数个数：$\prod (e_i+1)$。

约数和：$\prod (1+p_i+p_i^2+\cdots+p_i^{e_i})=\prod \frac{p_i^{e_i+1} - 1}{p_i-1}$。

